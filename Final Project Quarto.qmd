---
title: "Final Project Quarto"
format: html
echo: false
warning: false
---

```{r}
#| message: false
#load packages and data set
library("tidyverse")
library("usethis")
library("here")
library("flextable")
library("broom")
library("renv")
library("gtsummary")
library("dplyr")
uk<-read_csv(here::here("data","english_education.csv"))

```
The present report uses the "Educational attainment of young people in English towns" data set provided by the UK Office of National Statistics. The data set collected information based on students who took their GCSEs between 2012 and 2013. 

```{r}
#| label: tbl-test
#| tbl-cap: "A table!"
knitr::kable(uk)
```


```{r}
#descriptive statistics
#| label: tbl-descriptive
#| tbl-cap: Descriptive statistics


tbl_descriptive<-tbl_summary(
	uk,
	by = coastal,
	include= c("population_2011","income_flag","university_flag","education_score"),
	label=list(
		population_2011~"Town Population Size",
		income_flag~"Town Income Deprivation Status",
		university_flag~"Presence of University in Town",
		education_score~"Education Score"
	),
missing_text="Missing")|>
modify_caption("**Table 1: Descriptive Statistics**")
tbl_descriptive

#inline stats
coastaldep<- inline_text(tbl_descriptive, variable= "income_flag", level = "Higher deprivation towns", column = "Coastal")
noncoastaldep<- inline_text(tbl_descriptive, variable = "income_flag", level = "Higher deprivation towns", column = "Non-coastal")
stats<-list(n=nrow(uk),
									median_edu=median(uk$education_score, na.rm=TRUE))

#function
percentmissing<-function(df,var){
	missing<-sum(is.na(df[[var]]))
	total<-nrow(df)
	missing/total*100
}

```
Descriptive statistics of the cohort are depicted above (@tbl-descriptive). `r coastaldep` of the coastal towns are higher deprivation towns, while `r noncoastaldep` of non-coastal towns are higher deprivation. The median education score of the cohort is `r stats$median_edu`. 
```{r}
#figure

#| label:fig-pop-hist
#| fig-cap: "Histogram of Population Size"

hist(uk$education_score)

```
@fig-pop-hist depicts education score distribution. Some values are missing for educational attainment measures, though it is a small portion of the data. For example, `r percentmissing(uk,"activity_at_age_19_sustained_further_education")` percent of data is missing for Sustained Further Education at Age 19. 

A linear regression was conducted to assess the association between education score and multiple town factors, including town income deprivation status, presence of university in town, and population size. Regression results are shown below. 
```{r}
#regression


linear_model<-lm(education_score ~ income_flag + university_flag + population_2011, data=uk)

tbl_regression(
	linear_model,
	intercept=TRUE,
	label=list(
		income_flag~"Town Income Deprivation Status",
		university_flag~"Presence of University in Town",
		population_2011~"Population Size"
	)
)

```


